# WhatsApp PDF Sharing Feature

## Overview
The reports page now supports sharing meeting reports as PDFs via WhatsApp. When you share a report via WhatsApp, the system:

1. Generates a PDF of the custom report with all sections
2. Saves it temporarily in `public/temp-pdfs/` folder
3. Creates a shareable download link
4. Generates WhatsApp Web links with the PDF download URL
5. Automatically cleans up PDFs after 24 hours

## How It Works

### Sharing Reports via WhatsApp
1. Go to the Reports page for any meeting
2. Fill in the report form (or use pre-populated data)
3. Click "Send via WhatsApp"
4. Enter phone numbers (one per line, with country code)
5. Click "Generate Links"
6. The system will:
   - Generate the report PDF
   - Save it temporarily with a unique filename
   - Create WhatsApp links with the PDF download URL
   - Copy all links to your clipboard
   - Show you the PDF URL and all WhatsApp links

### PDF Link Format
```
https://yourdomain.com/temp-pdfs/report-{meetingId}-{timestamp}.pdf
```

### WhatsApp Message Format
```
üìä Meeting Report

{Meeting Title}

üìÖ Date: {Date}
‚è∞ Time: {Time}
üë§ Organizer: {Name}

üìé Download Report PDF:
{PDF URL}

This link will expire in 24 hours
Generated by Meeting Management System
```

## Automatic Cleanup

### Scheduled Cleanup
PDFs are automatically deleted after 24 hours using a setTimeout in the API endpoint.

### Manual Cleanup
You can also manually trigger cleanup by calling:
```
GET /api/cleanup-temp-pdfs
```

This will delete all PDFs older than 24 hours from the `public/temp-pdfs/` folder.

## Environment Variables

Make sure `NEXTAUTH_URL` is set in your `.env` file:
```
NEXTAUTH_URL=https://yourdomain.com
```

This is used to generate the full PDF download URL.

## Security Considerations

1. **Temporary Storage**: PDFs are stored temporarily and auto-deleted after 24 hours
2. **Public Access**: PDFs are publicly accessible via URL (no authentication required)
3. **Unique Filenames**: Each PDF has a unique timestamp-based filename
4. **No Sensitive Data**: Ensure meeting reports don't contain highly sensitive information if sharing via public URLs

## Folder Structure

```
public/
  temp-pdfs/          # Temporary PDF storage (auto-created)
    report-{id}-{timestamp}.pdf
```

## API Endpoints

### Generate WhatsApp Links with PDF
```
POST /api/meetings/[id]/whatsapp-report
Body: {
  phoneNumbers: string[],
  reportData: {
    executiveSummary: string,
    objectives: string,
    keyDiscussionPoints: array,
    decisionsTaken: array,
    actionItems: array,
    risksIdentified: array,
    conclusion: string
  }
}
```

### Cleanup Old PDFs
```
GET /api/cleanup-temp-pdfs
```

## Troubleshooting

### PDFs Not Generating
- Check if Puppeteer is installed: `npm install puppeteer`
- Ensure the `public/temp-pdfs/` directory can be created
- Check server logs for PDF generation errors

### Links Not Working
- Verify `NEXTAUTH_URL` is set correctly
- Check if the PDF file exists in `public/temp-pdfs/`
- Ensure the web server can serve files from the public folder

### Cleanup Not Working
- Check server logs for cleanup errors
- Manually call `/api/cleanup-temp-pdfs` to test
- Verify file permissions on the temp-pdfs folder

## Production Deployment

For production, consider:
1. Using a CDN or cloud storage (S3, Azure Blob, etc.) instead of local storage
2. Implementing a cron job to call the cleanup endpoint regularly
3. Adding rate limiting to prevent abuse
4. Implementing authentication for PDF access if needed
5. Using signed URLs with expiration for better security
